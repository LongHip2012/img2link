$(function(){"use strict";Wstoast.config({autoClose:!0,showClose:!0,html:!0});let e={loader:function(e){e?$(".td-loader").length?$(".td-loader").show():$("body").append($('<div class="td-loader"><img src="./assets/img/loader.gif" alt="Loading..."></div>').show()):$(".td-loader").hide()}},t=$("#drop-area");function a(t){if(t.length>0){e.loader(!0),Wstoast.loading("Waiting uploading..."),$("#LoaderV2").removeClass("hide");let a=new FormData,o=$('input[name="ft"]:checked').val();a.append("ft",o),a.append("action","upload-img"),$.each(t,function(e,t){a.append("file[]",t)}),$.ajax({url:"./upload.php",type:"POST",data:a,processData:!1,contentType:!1,dataType:"json",success:function(t){if(Wstoast.closeAll(),e.loader(!1),$("#LoaderV2").addClass("hide"),"success"===t.status){let a=t.data;Wstoast.success(t.msg),a.reverse().slice(0,3).forEach(e=>{let t=$('<div class="file-item p-2 border mb-2 rounded bg-gray-100"></div>'),a=$('<p class="text-md font-semibold truncate"></p>').text(`T\xean ảnh: ${e.name}`),o=$('<p class="text-sm text-gray"></p>').text(`Dung lượng: ${e.size}`),n=$('<a class="text-blue-600 hover:underline truncate" target="_blank"></a>').html(e.link+' <i class="text-red ri-file-copy-line copy cursor-pointer"></i>');n.find(".copy").on("click",function(t){t.preventDefault(),navigator.clipboard.writeText(e.link).then(()=>{Wstoast.success("Đ\xe3 sao ch\xe9p v\xe0o bộ nhớ tạm!")}).catch(e=>{Wstoast.error("Lỗi khi sao ch\xe9p v\xe0o bộ nhớ tạm!")})}),t.append(a,o,n),$(".preload").prepend(t)}),$("#file").val(""),a.length>3&&$(".preload").css("overflow-y","auto").css("max-height","250px")}else Wstoast.error(t.msg)},error:function(e){Wstoast.error("Mất kết nối...")}})}}t.on("dragenter dragover",function(e){e.preventDefault(),e.stopPropagation(),t.addClass("bg-red")}),t.on("dragleave drop",function(e){e.preventDefault(),e.stopPropagation(),t.removeClass("bg-red")}),t.on("drop",function(e){let t=e.originalEvent.dataTransfer.files;a(t)}),$("body").on("change","#file",function(){let e=$("#file")[0].files;a(e)})});